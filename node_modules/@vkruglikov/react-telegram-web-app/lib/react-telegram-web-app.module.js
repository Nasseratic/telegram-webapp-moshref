import n,{createContext as t,useContext as o,useEffect as r,useId as u,useCallback as e,useState as l,useMemo as i}from"react";var c,a="undefined"!=typeof window&&null!=(c=window)&&null!=(c=c.Telegram)&&c.WebApp?window.Telegram.WebApp:null,f=t(a),d={smoothButtonsTransition:!1,smoothButtonsTransitionMs:50},s=t(d),v=function(){return{MainButton:{current:null},BackButton:{current:null}}},p=t({MainButton:{current:null},BackButton:{current:null}}),h=function(){},m=function(n){var t=n.id,u=n.show,e=void 0===u?h:u,l=n.hide,i=void 0===l?h:l,c=n.currentShowedIdRef,a=o(s),f=a.smoothButtonsTransition,d=a.smoothButtonsTransitionMs;r(function(){return e(),c.current=t,function(){f?(c.current=null,setTimeout(function(){c.current||i()},d)):(i(),c.current=null)}},[i,t,c,e,f,d])},w=function(){return o(f)},P=function(n){var t=n.text,e=void 0===t?"CONTINUE":t,l=n.progress,i=void 0!==l&&l,c=n.disable,a=void 0!==c&&c,f=n.color,d=n.textColor,s=n.onClick,v=o(p),h=u(),P=w(),B=null==P?void 0:P.MainButton,b=null==P?void 0:P.themeParams;return r(function(){null==B||B.setParams({color:f||(null==b?void 0:b.button_color)||"#fff"})},[f,b,B]),r(function(){null==B||B.setParams({text_color:d||(null==b?void 0:b.button_text_color)||"#000"})},[B,b,d]),r(function(){null==B||B.setText(e)},[e,B]),r(function(){a?null==B||B.disable():a||null==B||B.enable()},[a,B]),r(function(){i?null==B||B.showProgress(!1):i||null==B||B.hideProgress()},[i,B]),r(function(){if(s)return null==B||B.onClick(s),function(){null==B||B.offClick(s)}},[s,B]),m({show:null==B?void 0:B.show,hide:null==B?void 0:B.hide,currentShowedIdRef:v.MainButton,id:h}),null},B=function(n){var t=n.onClick,e=o(p),l=u(),i=w(),c=null==i?void 0:i.BackButton;return m({show:null==c?void 0:c.show,hide:null==c?void 0:c.hide,currentShowedIdRef:e.BackButton,id:l}),r(function(){if(t&&c)return c.onClick(t),function(){c.offClick(t)}},[t,c]),null},b=function(){var n=w();return e(function(t){return new Promise(function(o,r){try{null==n||null==n.showPopup||n.showPopup(t,function(n){o(n)})}catch(n){r(n)}})},[n])},C=function(){var n=w(),t=null==n?void 0:n.HapticFeedback,o=e(function(){return null==t?void 0:t.impactOccurred.apply(t,[].slice.call(arguments))},[t]),r=e(function(){return null==t?void 0:t.notificationOccurred.apply(t,[].slice.call(arguments))},[t]),u=e(function(){return null==t?void 0:t.selectionChanged.apply(t,[].slice.call(arguments))},[t]);return[o,r,u]},g=function(){var n=w(),t=l(null==n?void 0:n.colorScheme),o=t[0],u=t[1],e=l((null==n?void 0:n.themeParams)||{}),i=e[0],c=e[1];return r(function(){if(n){var t=function(){u(n.colorScheme),c(n.themeParams)};return n.onEvent("themeChanged",t),function(){n.offEvent("themeChanged",t)}}},[n]),[o,i]},x=function(){var n=w(),t=e(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[t,e(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},y=function(){var n=w();return e(function(){return new Promise(function(t){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(t)})},[n])},k=function(){var n=w();return e(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},S=function(){var n=w(),t=l(null==n?void 0:n.isExpanded),o=t[0],u=t[1];return r(function(){if(n){var t=function(t){t.isStateStable&&u(n.isExpanded)};return n.onEvent("viewportChanged",t),function(){return n.offEvent("viewportChanged",t)}}},[n]),[o,e(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]};function T(){return T=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(n[r]=o[r])}return n},T.apply(this,arguments)}var E=function(t){var o=t.children,r=t.options,u=i(function(){return T({},d,r)},[r]),e=i(v,[]);return n.createElement(p.Provider,{value:e},n.createElement(f.Provider,{value:a},n.createElement(s.Provider,{value:u},o)))};export{B as BackButton,P as MainButton,E as WebAppProvider,S as useExpand,C as useHapticFeedback,y as useReadTextFromClipboard,x as useScanQrPopup,b as useShowPopup,k as useSwitchInlineQuery,g as useThemeParams};
